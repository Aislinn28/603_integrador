import{u as W}from"./reservas-FbF4vKKn.js";import{_ as X,r as x,p as Y,c as R,w as n,a as i,o as l,b as a,e as s,f as d,h as _,g as r,F as Z,s as tt,t as c,d as u}from"./index-C2aYM6LG.js";import"./ReservasService-CEgvyNxi.js";import"./http-CD2YnwdB.js";const et={key:0,class:"text-center pa-4"},at={key:1,class:"text-center pa-4"},ot={key:2},nt={class:"mb-3"},st={class:"mb-3"},lt={class:"mb-3"},rt={class:"mb-3"},it={key:0,class:"mb-2"},dt={class:"pl-4"},ct={key:0,class:"text-caption"},ut={key:1,class:"text-caption"},mt={key:2,class:"text-caption"},vt={key:3,class:"text-caption"},_t={key:4,class:"text-caption"},pt={key:5,class:"text-caption"},ft={class:"text-caption font-weight-bold"},gt={key:1,class:"mb-2"},yt={class:"pl-4"},kt={class:"text-caption"},bt={key:0,class:"text-caption"},xt={class:"text-caption font-weight-bold"},Ct={class:"text-h6 text-center primary--text font-weight-bold"},wt={key:0},Et={key:1},ht={__name:"MisReservas",setup(zt){const m=W(),p=x({show:!1,message:"",color:"success"}),f=x(!1),C=x(""),g=x(null),y=(o,t="success")=>{p.value={show:!0,message:o,color:t}},M=o=>o?o==="pendiente"?"yellow lighten-4":o==="confirmada"?"green lighten-4":o==="cancelada"?"red lighten-4":"grey lighten-3":"grey lighten-3",N=o=>o?o==="pendiente"?"yellow":o==="confirmada"?"green":o==="cancelada"?"red":"grey":"grey",T=o=>new Date(o+"T00:00:00").toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),B=o=>{switch(o){case"autolavado":return"Autolavado";case"estacionamiento":return"Estacionamiento";case"ambos":return"Autolavado + Estacionamiento";default:return o}},D=o=>o.tipo_servicio==="autolavado"||o.tipo_servicio==="ambos",F=o=>o.tipo_servicio==="estacionamiento"||o.tipo_servicio==="ambos",w=(o,t)=>{const k={confirmada:"¿Confirmar esta reserva?",completada:"¿Marcar esta reserva como completada?",cancelada:"¿Cancelar esta reserva?"};C.value=k[t],g.value=()=>U(o,t),f.value=!0},U=async(o,t)=>{try{await m.actualizarEstado(o,t),y(`Reserva ${t} exitosamente`)}catch(k){console.error("Error al cambiar estado:",k),y("Error al cambiar el estado de la reserva","error")}},I=o=>{C.value="¿Eliminar esta reserva permanentemente?",g.value=()=>O(o),f.value=!0},O=async o=>{try{await m.eliminarReserva(o),y("Reserva eliminada exitosamente")}catch(t){console.error("Error al eliminar reserva:",t),y("Error al eliminar la reserva","error")}},P=()=>{g.value&&(g.value(),g.value=null),f.value=!1};return Y(async()=>{try{await m.cargarReservas()}catch(o){console.error("Error al cargar reservas:",o),y("Error al cargar las reservas","error")}}),(o,t)=>{const k=i("v-toolbar-title"),E=i("v-spacer"),v=i("v-btn"),H=i("v-toolbar"),q=i("v-progress-circular"),b=i("v-icon"),G=i("v-chip"),L=i("v-card-title"),V=i("v-divider"),h=i("v-card-text"),j=i("v-card-actions"),z=i("v-card"),S=i("v-col"),A=i("v-row"),J=i("v-snackbar"),K=i("v-dialog"),Q=i("v-container");return l(),R(Q,{class:"fill-height",fluid:""},{default:n(()=>[a(A,{justify:"center"},{default:n(()=>[a(S,{cols:"12"},{default:n(()=>[a(z,{elevation:"12"},{default:n(()=>[a(H,{flat:"",color:"primary",dark:""},{default:n(()=>[a(k,null,{default:n(()=>t[6]||(t[6]=[s("Mis Reservas")])),_:1}),a(E),a(v,{color:"white",variant:"text",onClick:t[0]||(t[0]=e=>o.$router.push("/realizar-reserva"))},{default:n(()=>t[7]||(t[7]=[s(" Nueva Reserva ")])),_:1})]),_:1}),a(h,null,{default:n(()=>[_(m).estaLoading?(l(),d("div",et,[a(q,{indeterminate:"",color:"primary",size:"64"}),t[8]||(t[8]=r("p",{class:"mt-2"},"Cargando reservas...",-1))])):_(m).obtenerReservas.length===0?(l(),d("div",at,[a(b,{size:"64",color:"grey"},{default:n(()=>t[9]||(t[9]=[s("mdi-calendar-blank")])),_:1}),t[11]||(t[11]=r("h3",{class:"mt-2"},"No tienes reservas",-1)),t[12]||(t[12]=r("p",{class:"text-grey"},"Crea tu primera reserva para comenzar",-1)),a(v,{color:"primary",class:"mt-2",onClick:t[1]||(t[1]=e=>o.$router.push("/realizar-reserva"))},{default:n(()=>t[10]||(t[10]=[s(" Crear Reserva ")])),_:1})])):(l(),d("div",ot,[a(A,null,{default:n(()=>[(l(!0),d(Z,null,tt(_(m).obtenerReservas,e=>(l(),R(S,{key:e.id,cols:"12",md:"6",lg:"4"},{default:n(()=>[a(z,{color:M(e.estado),variant:"outlined",class:"reserva-card"},{default:n(()=>[a(L,{class:"d-flex justify-space-between align-center"},{default:n(()=>[r("span",null,"Reserva #"+c(e.id),1),a(G,{color:N(e.estado),size:"small",variant:"flat"},{default:n(()=>[s(c(e.estado?e.estado.toUpperCase():""),1)]),_:2},1032,["color"])]),_:2},1024),a(h,null,{default:n(()=>[r("div",nt,[a(b,{small:"",class:"mr-2"},{default:n(()=>t[13]||(t[13]=[s("mdi-calendar")])),_:1}),r("strong",null,c(T(e.fecha)),1)]),r("div",st,[a(b,{small:"",class:"mr-2"},{default:n(()=>t[14]||(t[14]=[s("mdi-clock")])),_:1}),r("strong",null,c(e.hora),1)]),r("div",lt,[a(b,{small:"",class:"mr-2"},{default:n(()=>t[15]||(t[15]=[s("mdi-car")])),_:1}),s(" "+c(e.placa)+" - "+c(e.color)+" "+c(e.modelo),1)]),r("div",rt,[a(b,{small:"",class:"mr-2"},{default:n(()=>t[16]||(t[16]=[s("mdi-wrench")])),_:1}),s(" "+c(B(e.tipo_servicio)),1)]),a(V,{class:"my-2"}),D(e)?(l(),d("div",it,[t[17]||(t[17]=r("h4",{class:"text-subtitle-2 primary--text"},"Autolavado:",-1)),r("div",dt,[e.lavado_exterior?(l(),d("div",ct," ✓ Lavado Exterior ")):u("",!0),e.lavado_interior?(l(),d("div",ut," ✓ Lavado Interior ")):u("",!0),e.encerado?(l(),d("div",mt,"✓ Encerado")):u("",!0),e.aspirado?(l(),d("div",vt,"✓ Aspirado")):u("",!0),e.limpieza_llantas?(l(),d("div",_t," ✓ Limpieza de Llantas ")):u("",!0),e.aromatizante?(l(),d("div",pt,"✓ Aromatizante")):u("",!0),r("div",ft," Subtotal: $"+c(e.subtotal_autolavado||0),1)])])):u("",!0),F(e)?(l(),d("div",gt,[t[18]||(t[18]=r("h4",{class:"text-subtitle-2 primary--text"},"Estacionamiento:",-1)),r("div",yt,[r("div",kt,c(e.tipo_tarifa==="tiempo_completo"?"Tiempo Completo":`Por Hora (${e.horas_estimadas}h)`),1),e.hora_salida?(l(),d("div",bt," Salida estimada: "+c(e.hora_salida),1)):u("",!0),r("div",xt," Subtotal: $"+c(e.subtotal_estacionamiento||0),1)])])):u("",!0),a(V,{class:"my-2"}),r("div",Ct," Total: $"+c(e.total),1)]),_:2},1024),a(j,null,{default:n(()=>[a(E),e.estado==="pendiente"?(l(),d("div",wt,[a(v,{color:"error",variant:"text",size:"small",onClick:$=>w(e.id,"cancelada"),loading:_(m).estaLoading},{default:n(()=>t[19]||(t[19]=[s(" Cancelar ")])),_:2},1032,["onClick","loading"]),a(v,{color:"success",variant:"text",size:"small",onClick:$=>w(e.id,"confirmada"),loading:_(m).estaLoading},{default:n(()=>t[20]||(t[20]=[s(" Confirmar ")])),_:2},1032,["onClick","loading"])])):e.estado==="confirmada"?(l(),d("div",Et,[a(v,{color:"primary",variant:"text",size:"small",onClick:$=>w(e.id,"completada"),loading:_(m).estaLoading},{default:n(()=>t[21]||(t[21]=[s(" Marcar Completada ")])),_:2},1032,["onClick","loading"])])):u("",!0),["cancelada","completada"].includes(e.estado)?(l(),R(v,{key:2,color:"error",variant:"text",size:"small",onClick:$=>I(e.id),loading:_(m).estaLoading},{default:n(()=>t[22]||(t[22]=[s(" Eliminar ")])),_:2},1032,["onClick","loading"])):u("",!0)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1})]))]),_:1})]),_:1})]),_:1})]),_:1}),a(J,{modelValue:p.value.show,"onUpdate:modelValue":t[3]||(t[3]=e=>p.value.show=e),color:p.value.color,timeout:3e3},{actions:n(()=>[a(v,{variant:"text",onClick:t[2]||(t[2]=e=>p.value.show=!1)},{default:n(()=>t[23]||(t[23]=[s(" Cerrar ")])),_:1})]),default:n(()=>[s(c(p.value.message)+" ",1)]),_:1},8,["modelValue","color"]),a(K,{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=e=>f.value=e),"max-width":"400"},{default:n(()=>[a(z,null,{default:n(()=>[a(L,null,{default:n(()=>t[24]||(t[24]=[s("Confirmar Acción")])),_:1}),a(h,null,{default:n(()=>[s(c(C.value),1)]),_:1}),a(j,null,{default:n(()=>[a(E),a(v,{color:"grey",variant:"text",onClick:t[4]||(t[4]=e=>f.value=!1)},{default:n(()=>t[25]||(t[25]=[s(" Cancelar ")])),_:1}),a(v,{color:"primary",onClick:P},{default:n(()=>t[26]||(t[26]=[s(" Confirmar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},jt=X(ht,[["__scopeId","data-v-6a712e6d"]]);export{jt as default};
